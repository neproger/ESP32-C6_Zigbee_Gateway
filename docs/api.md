# API (as-is)

Этот документ описывает то, что **реально реализовано сейчас** (не “целевая” архитектура).

См. также: `docs/current-state.md`.

## Web UI

- `GET /` — простая HTML‑страница UI.

## Devices

### `GET /api/devices`

Возвращает массив устройств из реестра устройств (NVS-backed, сохраняется между перезагрузками).

Ответ (пример):

```json
[
  {
    "device_uid": "0x00124B0012345678",
    "name": "Device",
    "short_addr": 0,
    "has_onoff": true,
    "has_button": false
  }
]
```

### `POST /api/devices?uid=...&name=...&onoff=0|1&button=0|1`

Добавляет/обновляет запись в реестре (временный “ручной” API для теста UI).

Примечание: это **частичное обновление**. Поля, которые не переданы в query, сохраняются как были (например, `short_addr`, `has_onoff`, `has_button`, `name`).

Параметры:
- `uid` (обязательно) — строка вида `0x00124B0012345678`
- `name` (опционально) — имя
- `onoff` (опционально) — `1` или `0`
- `button` (опционально) — `1` или `0`

Ответ:

```json
{"ok":true}
```

## Планируемые эндпоинты (to-be)

Список целей см. `docs/architecture.md` (“Черновик REST API”).
